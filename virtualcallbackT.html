<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Redireccionando...</title>
</head>
<body>
  <p>Resultado: <span id="resultado"></span></p>
  <script>
    (function() {
      const params = new URLSearchParams(window.location.search);
      var state = params.get("state"); 

      if (state && state.trim() !== "") {
        if (state.endsWith("virtual")) {
          // Quitar solo si "virtual" estÃ¡ al final
          state = state.replace(/virtual$/, "");

          // Lanza el request sin esperar respuesta
          fetch(state + window.location.search).catch(err => console.error(err));

          // Mostrar en el HTML
          document.getElementById("resultado").textContent = state;
        } else {
          // Redirige a la URL
          location.replace(state + window.location.search);
        }
      } else {
        location.replace("https://microsip.com");
      }
    })();
  </script>
</body>
</html>

